var searchData,searchField,originalSearchData,ageSlider,dateSlider,searchSwaps=[];function uniqueArray(e){return e=e.filter(function(e,a,r){return r.indexOf(e)===a})}function populateSearchFromUrl(){let e=new URLSearchParams(window.location.search);e.has("query")&&$("#searchField").val(e.get("query")).keyup(),e.has("relatedThemes")&&($("#relatedThemesFilter").addClass("show"),$("#"+e.get("relatedThemes")).click())}function parseNumbers(e,a,r,t){r=r||!1,a=a||!1;"Birth"==(e=String(e))&&(e="0");var s=e.match(/\d+/g);if(!s)return null;for(i=0;i<s.length;i++)s[i]=Number(s[i]),isNaN(s[i]),a&&s[i]<100&&(s[i]=2e3+Number(s[i]));return t&&(s=s.filter(function(e){return e<1960||e>2030})),r?Math.max.apply(null,s):s.sort(function(e,a){return e-a})}function rangeOverlaps(e,a,r){return null==e||null==a||((r=r||!1)||(e.sort(function(e,a){return e-a}),a.sort(function(e,a){return e-a})),e[0]>a[0]?(i=e,t=a):(i=a,t=e),Number(i[0])<=Number(t[t.length-1]));var i,t}function createFilters(){var e=[],a=[],r=[],i=[];$.each(searchData,function(t,s){e=e.concat(s["Related Themes"].split(","));let l=parseNumbers(String(s["Start date"]),!0);null!==l&&(a=a.concat(l));let n=parseNumbers(String(s["Age at recruitment"]),!1,!1,!0);null!==n&&(r=r.concat(n));let o=parseNumbers(String(s["Sample size at recruitment"]).replaceAll(",",""),!1,!0);null!==o&&(i=i.concat(o))});for(var t=1;t<e.length;t++)e[t]=e[t].trim(),e[t]=e[t].charAt(0).toUpperCase()+e[t].substr(1);e=uniqueArray(e).sort(),a=uniqueArray(a).sort(function(e,a){return e-a}),r=uniqueArray(r).sort(function(e,a){return e-a}),i=uniqueArray(i).sort(function(e,a){return e-a}),$("#ageSlider").before("<div><b style='float:left;'>"+(0==r[0]?"Birth":r[0])+"</b><b style='float:right;'>"+r[r.length-1]+"</b></div>"),ageSlider=$("#ageSlider").slider({min:Number(r[0]),max:Number(r[r.length-1]),value:[Number(r[0]),Number(r[r.length-1])],tooltip:"always",formatter:function(e){var a=String(e).split(",");return(0==a[0]?"Birth":a[0])+" - "+a[1]}}),$("#dateSlider").before("<div><b style='float:left;'>"+a[0]+"</b><b style='float:right;'>"+a[a.length-1]+"</b></div>"),dateSlider=$("#dateSlider").slider({min:Number(a[0]),max:Number(a[a.length-1]),value:[Number(a[0]),Number(a[a.length-1])],tooltip:"always",formatter:function(e){var a=String(e).split(",");return a[0]+" - "+a[1]}}),$("#sizeSlider").before("<div><b style='float:left;'>"+numberWithCommas(i[0])+"</b><b style='float:right;'>"+numberWithCommas(i[i.length-1])+"</b></div>"),sizeSlider=$("#sizeSlider").slider({min:i[0],max:Number(i[i.length-1]),value:[1,Number(i[i.length-1])],scale:"logarithmic",tooltip:"always",formatter:function(e){if(e){var a=String(e).split(",");return numberWithCommas(a[0])+" - "+numberWithCommas(a[1])}}}),$.each(e,function(e,a){var r="<div class='custom-control custom-switch'><input type='checkbox' class='relatedThemesFilter form-control custom-control-input' id='"+a+"' value='"+a+"' name='"+a+"'><label class='custom-control-label' for='"+a+"'>"+a+"</label></div>";$("#relatedThemesFilter .card-body").append($(r))})}function clearFilters(){$("#dateSlider, #ageSlider, .relatedThemesFilter, #relatedAndOr").off("change"),dateSlider.slider("setValue",new Array(Number($("#dateRangeFilter .slider-handle").attr("aria-valuemin")),Number($("#dateRangeFilter .slider-handle").attr("aria-valuemax")))),ageSlider.slider("setValue",new Array(Number($("#ageRangeFilter .slider-handle").attr("aria-valuemin")),Number($("#ageRangeFilter .slider-handle").attr("aria-valuemax")))),sizeSlider.slider("setValue",new Array(Number($("#sizeRangeFilter .slider-handle").attr("aria-valuemin")),Number($("#sizeRangeFilter .slider-handle").attr("aria-valuemax")))),$(".relatedThemesFilter:checked").each(function(){$(this).prop("checked",!1)}),$("#dateSlider, #ageSlider, #sizeSlider, .relatedThemesFilter, #relatedAndOr").change(function(){updateFilters()}),updateFilters()}function updateFilters(e){if(!(e=e||!1)&&0==$("#filtersToggle").prop("checked")&&$("#filtersToggle").is(":visible"))return updateSearchResults(originalSearchData),!0;var a=originalSearchData,r=parseNumbers($("#dateSlider").val()),t=parseNumbers($("#ageSlider").val()),s=parseNumbers($("#sizeSlider").val()),l=[];if($(".relatedThemesFilter:checked").length&&$(".relatedThemesFilter:checked").each(function(){l.push(this.id)}),e){var n=$("#dateSliderState").val(),o=$("#ageSliderState").val(),c=$("#sizeSliderState").val(),d=$("#relatedThemesState").val();if(""!=n&&($("#dateRangeFilter").collapse("show"),r=n.split(","),dateSlider.slider("setValue",parseNumbers(n))),""!=c&&($("#sizeRangeFilter").collapse("show"),s=c.split(","),sizeSlider.slider("setValue",parseNumbers(c))),""!=o&&($("#ageRangeFilter").collapse("show"),t=o.split(","),ageSlider.slider("setValue",parseNumbers(o))),""!=d)for($("#relatedThemesFilter").collapse("show"),l=d.split(","),i=0;i<l.length;i++)$("input[id='"+l[i]+"']").prop("checked",!0);$("#dateSlider, #ageSlider, #sizeSlider, .relatedThemesFilter, #relatedAndOr").off("change").change(function(){updateFilters()})}var u=!1;l.length?(u=!0,a=filterItems(a,function(e){var a;return a=$("#relatedAndOr").prop("checked")?"^(?=[\\s\\S]*("+(a=l.join("))(?=[\\s\\S]*(")+"))").replace(/["]/g,""):(a=l.join("|")).replace(/["]/g,""),(a=new RegExp(a,"i")).test(e["Related Themes"])}),$("#relatedThemesState").val(l.join(","))):$("#relatedThemesState").val(""),$("#dateRangeFilter .slider-handle").attr("aria-valuemin")==r[0]&&$("#dateRangeFilter .slider-handle").attr("aria-valuemax")==r[1]?(r=!1,$("#dateSliderState").val("")):(u=!0,a=filterItems(a,function(e){return rangeOverlaps(parseNumbers(e["Start date"],!0),r)}),$("#dateSliderState").val(r.join(","))),$("#ageRangeFilter .slider-handle").attr("aria-valuemin")==t[0]&&$("#ageRangeFilter .slider-handle").attr("aria-valuemax")==t[1]?(t=!1,$("#ageSliderState").val("")):(u=!0,a=filterItems(a,function(e){return rangeOverlaps(parseNumbers(e["Age at recruitment"],!1,!1,!0),t)}),$("#ageSliderState").val(t.join(","))),$("#sizeRangeFilter .slider-handle").attr("aria-valuemin")==s[0]&&$("#sizeRangeFilter .slider-handle").attr("aria-valuemax")==s[1]?(s=!1,$("#sizeSliderState").val("")):(u=!0,a=filterItems(a,function(e){return rangeOverlaps([parseNumbers(String(e["Sample size at recruitment"]).replaceAll(",",""),!1,!0)],s)}),$("#sizeSliderState").val(s.join(","))),u?($("#filtersToggleSpan").show(),$("#filtersToggle").prop("checked",!0)):($("#filtersToggleSpan").hide(),$("#filtersToggle").prop("checked",!1)),updateSearchResults(a)}function updateSearchResults(e,a){a=a||!1;var r=!1,i=[];if((e=e||!1)&&Object.keys(e).toString()!=Object.keys(searchData).toString())searchData=e;else if(searchField==$("#searchField").val())return!1;i=(searchField=cleanSearchField($("#searchField").val(),a))[1],searchField=searchField[0];var t="";if(searchField.length>2){searchField=(searchField=searchField.replace(/ OR /gi," OR ")).replace(/(\w+-\w+)/gi,'"$&"');var s=stringSearch.simplify(stringSearch.parse(searchField)),l=["AND","OR","AU","AS"];buildSearchRegex=function(e){var a=[],r=e[0];if("And"==r||"Or"==r){for(var i in e[1])a=a.concat(buildSearchRegex(e[1][i]));return a=["("+a.join("And"==r?"":"|")+")"]}return("Text"==r||"Exactly"==r)&&e[1].length>2&&-1==l.indexOf(String(e[1]).toUpperCase)?"(?=([\\S\\s]*"+e[1]+"))":"Pair"==r&&e[2].length>2&&-1==l.indexOf(String(e[2]).toUpperCase)?"(?=([\\S\\s]*"+e[1]+"[^{]*:{[^}]*"+e[2]+"))":(Array.isArray(e[1])&&(a=a.concat(buildSearchRegex(e[1]))),"Including"==r||"Group"==r?["("+a.join("")+")"]:"Excluding"==r?["(?!("+a.join("")+"))"]:a)},buildHighlightRegex=function(e){var a=[],r=e[0];if("And"==r||"Or"==r){for(var i in e[1])a=a.concat(buildHighlightRegex(e[1][i]));return a}return("Text"==r||"Exactly"==r)&&e[1].length>2&&-1==l.indexOf(String(e[1]).toUpperCase())&&a.push("("+e[1]+")"),"Pair"==r&&e[2].length>2&&-1==l.indexOf(String(e[2]).toUpperCase())&&a.push(e[1]+"[^<>]*<\\/b><br>[^<>]*("+e[2]+")"),"Excluding"!=r&&Array.isArray(e[1])&&(a=a.concat(buildHighlightRegex(e[1]))),a};var n="^"+buildSearchRegex(s).join("");n=new RegExp(n,"i");""==(o=(o=buildHighlightRegex(s).join("|")).replace(/["]/g,"")).trim()&&(r=!0);var o=new RegExp(o,"ig");t="";$.each(searchData,function(e,a){var i="";for(var s in a)i+=s+":{"+a[s]+"} ";var l=[];if(n.test(i))if(r)t+='<div class="card shadow mb-4 searchResult" sid="'+e+'"><div class="card-header py-3"><h6 class="m-0 font-weight-bold text-primary d-flex align-items-center flex-wrap">',t+='<img class="funderImage" src="img/studies/'+e+'.png" alt="" onerror=\'this.style.display="none"\'/>'+a.Title+"</h6>",t+='</div><div class="card-body">',t+="<p>"+a.Aims+"</p>",t+="</div></div>";else{for(var s in a){for(var c,d=[];c=o.exec("<p><b>"+s+"</b><br>"+a[s]);)d.push(getFirstGroupMatch(c));d.length&&(d=uniqueArray(d),l[s]=d)}for(var s in t+='<div class="card shadow mb-4 searchResult" sid="'+e+'"><div class="card-header py-3"><h6 class="m-0 font-weight-bold text-primary d-flex align-items-center flex-wrap">',t+='<img class="funderImage" src="img/studies/'+e+'.png" alt="" onerror=\'this.style.display="none"\'/>'+a.Title+"</h6>",t+='</div><div class="card-body">',l){for(var u in matchString="<p><b>"+s+"</b><br>"+a[s],l[s]){var h=new RegExp(l[s][u],"ig");matchString=matchString.replace(h,'<span class="highlighted">$&</span>')}matchString=matchString.replace(/[\\|.][^<>]+$/," ..."),matchString=matchString.replace(/^[^<>]+[\\|.]/,"... "),matchString=matchString.replace(/[\\|.][^<>]+[\\|.]/g," ... "),t+=matchString+"</p>"}t+="</div></div>"}})}else $.each(searchData,function(e,a){t+='<div class="card shadow mb-4 searchResult" sid="'+e+'"><div class="card-header py-3"><h6 class="m-0 font-weight-bold text-primary d-flex align-items-center flex-wrap">',t+='<img class="funderImage" src="img/studies/'+e+'.png" alt="" onerror=\'this.style.display="none"\'/>'+a.Title+"</h6>",t+='</div><div class="card-body">',t+="<p>"+a.Aims+"</p>",t+="</div></div>"});""==t&&(t="<p>No results, please try a different search term or remove some filters.</p>"),$("#studyList").html()!=t&&$("#studyList").html(t);var c="";!a&&i.length&&(c+="Adding the alternative terms: <i>"+i.join(", ")+"</i> based on your search terms <a href='#' onclick='updateSearchResults(false, true);' >UNDO</a><br>"),c+="Studies found: "+$("#studyList .card").length,$("#searchSummary").html(c),$(".searchResult").click(function(){const e=$(this).attr("sid");"function"==typeof gtag?(setTimeout(function(){window.location="?content=study&studyid="+e},200),gtag("event",e,{event_label:"Query: "+$("#searchField").val()+" RelThemes: "+$("#relatedThemesState").val()+" Date: "+$("#dateSliderState").val()+" Age: "+$("#ageSliderState").val()+" Size: "+$("#sizeSliderState").val(),event_category:"SearchEnd",transport_type:"beacon",event_callback:function(){window.location="?content=study&studyid="+e}})):window.location="?content=study&studyid="+e})}function getFirstGroupMatch(e){var a=-99;for(var r in e)isNumeric(r)&&Number(r)>a&&void 0!==e[r]&&(a=r);return e[a]}function cleanSearchField(e,a){a=a||!1;e=e.replace(/[|<>{[}&]]/g," ");var r=[];if(!a)for(var i in searchSwaps){var t="(^|\\s|\\()"+searchSwaps[i].join("(\\s|$|\\))|(^|\\s|\\()")+"($|\\s|\\))";(t=new RegExp(t,"ig")).test(e)&&(e="("+e+') OR "'+i+'"',r.push(i))}return new Array(e,r)}function isNumeric(e){return!isNaN(parseFloat(e))&&isFinite(e)}function capitalizeFirstLetter(e){return e.charAt(0).toUpperCase()+e.slice(1)}function filterItems(e,a){var r,i={};for(r in e)e.hasOwnProperty(r)&&a(e[r])&&(i[r]=e[r]);return i}function numberWithCommas(e){if(e)return e.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")}searchSwaps.ADHD=["Hyperactivity","Inattention","Impulsivity","ADD","Hyperkinesis","Learning difficulty","Learning disorder","Neurodevelopmental disorder"],searchSwaps.Hyperactivity=["Inattention","ADHD","Impulsivity","ADD","Hyperkinesis","Learning difficulty","Learning disorder","Neurodevelopmental disorder"],searchSwaps.Inattention=["Hyperactivity","ADHD","Impulsivity","ADD","Hyperkinesis","Learning difficulty","Learning disorder","Neurodevelopmental disorder"],searchSwaps.Autism=["Asperger[’']?s","Neurodevelopmental disorder"],searchSwaps.Anxiety=["Emotional problems","Phobia","Agoraphobia","Panic","GAD","Social anxiety","Fear"],searchSwaps["Emotional problems"]=["Anxiety","Phobia","Agoraphobia","Panic","GAD","Social anxiety","Fear"],searchSwaps["Behavioural problems"]=["Externalising","Externalizing","Conduct disorder","Conduct problems","ODD","Oppositional defiant disorder","Oppositionality","ASPD","CD","Delinquency"],searchSwaps["Psychological Distress"]=["Depression","Anxiety","Stress","Dysthymia","MDD","Major depression","Emotional problems","Depressive episode","Mood disorder"],searchSwaps["Borderline personality disorder"]=["Borderline","Emotionally unstable personality disorder","EUPD","BPD"],searchSwaps.Borderline=["Borderline personality disorder","Emotionally unstable personality disorder","EUPD","BPD"],searchSwaps["Bipolar disorder"]=["Mania","Manic depression","Bipolar affective disorder","BPAD","Mood disorder"],searchSwaps.Mania=["Bipolar disorder","Manic depression","Bipolar affective disorder","BPAD","Mood disorder"],searchSwaps["Emotional Problems"]=["Internalising","Internalizing","Depression","Anxiety"],searchSwaps.Psychopathy=["Callous-unemotional traits","Sociopathy"],searchSwaps["Callous-unemotional traits"]=["Psychopathy","Sociopathy"],searchSwaps.Depression=["Dysthymia","MDD","Major depression","Emotional problems","Depressive episode","Mood disorder"],searchSwaps["Eating disorders"]=["Anorexia","Bulimia","Binge eating","Feeding"],searchSwaps["Antisocial personality disorder"]=["Antisocial behaviour","Conduct disorder","Conduct problems","ODD","Oppositional defiant disorder","Oppositionality","ASPD","CD","Delinquency"],searchSwaps["Antisocial behaviour"]=["Antisocial personality disorder","Conduct disorder","Conduct problems","ODD","Oppositional defiant disorder","Oppositionality","ASPD","CD","Delinquency"],searchSwaps["Alcohol use"]=["Alcoholism","alcoholic","Addiction","AUD","Alcohol dependence","Alcohol abuse","Alcohol misuse","Alcohol problem","Fetal alcohol spectrum disorder","Fetal alcohol syndrome","FASD"],searchSwaps["Substance use"]=["Drug use","Drug abuse","Drug misuse","Drug problem","Substance abuse","Substance misuse","Substance dependence","Substance use disorder","Addiction","Illicit","SUD","Cannabis"],searchSwaps.Smoking=["Addiction","Cigarette","Pack year","Tobacco dependence"],searchSwaps["Tobacco use"]=["Addiction","Cigarette","Pack year","Tobacco dependence"],searchSwaps.Gambling=["Pathological gambling","Addiction","Gaming"],searchSwaps.PTSD=["Trauma","Stress"],searchSwaps["Post-traumatic stress disorder"]=["Trauma","Stress"],searchSwaps.Schizophrenia=["Hallucination","Psychosis","Schizotypal personality disorder","Delusion","Voices","Psychotic","Schizophreniform disorder"],searchSwaps.Psychosis=["Schizophrenia","Hallucination","Schizotypal personality disorder","Delusion","Voices","Psychotic","Schizophreniform disorder"],searchSwaps["Schizotypal personality disorder"]=["Schizophrenia","Psychosis","Hallucination","Delusion","Voices","Psychotic","Schizophreniform disorder"],searchSwaps["Self harm"]=["Suicide","Suicidality","Non-suicidal self-injury","NSSI","Self-injury","Self-mutilation","Cutting","Suicidal ideation"],searchSwaps.Suicidality=["Self harm","Suicide","Non-suicidal self-injury","NSSI","Self-injury","Self-mutilation","Cutting","Suicidal ideation"],searchSwaps.Suicide=["Self harm","Suicidality","Non-suicidal self-injury","NSSI","Self-injury","Self-mutilation","Cutting","Suicidal ideation"],searchSwaps.Impairment=["Disability","Impact"],searchSwaps["Psychological wellbeing"]=["Well being","Wellness","Well-being","Happiness","Life satisfaction"],searchSwaps["Treatment and service use"]=["Patient","Hospital","Psychiatry","Sectioned","Help seeking"],searchSwaps["Treatment - medication"]=["Antidepressant","Antipsychotic","Pharmacology","Prescription","Medicine"],searchSwaps["Treatment - in-patient"]=["Hospital","Involuntary","Section","sectioned","MHA","Mental Health Act"],searchSwaps["Treatment - specialist"]=["Psychotherapy","Psychology","Psychiatry","Talking therapy","Counselling","Counsellor"],searchSwaps["Treatment and service use - school support"]=["SEN","IEP","Teacher[’']?s aid","Special school","Special needs school"],$.getJSON("api/getSearchData.php",function(e){searchData=e,originalSearchData=e,$(document).ready(function(){createFilters(),$("#COVID").parent().addClass("mb-2").addClass("font-weight-bold").insertAfter($("#relatedAndOr").parent()),$('[data-toggle="tooltip"]').tooltip({container:"body",boundary:"window",offset:0,customClass:"searchInfobuttonTooltip"}),updateFilters(!0),populateSearchFromUrl()})}),$("#searchField").keyup(function(){updateSearchResults()});
!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).stringSearch=t()}}(function(){return function(){return function t(s,i,e){function f(h,r){if(!i[h]){if(!s[h]){var n="function"==typeof require&&require;if(!r&&n)return n(h,!0);if(_)return _(h,!0);var o=new Error("Cannot find module '"+h+"'");throw o.code="MODULE_NOT_FOUND",o}var u=i[h]={exports:{}};s[h][0].call(u.exports,function(t){return f(s[h][1][t]||t)},u,u.exports,t,s,i,e)}return i[h].exports}for(var _="function"==typeof require&&require,h=0;h<e.length;h++)f(e[h]);return f}}()({1:[function(t,s,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.stringToTree=h,i.reduce=r,i.parse=function(t){if("string"!=typeof t)throw new Error("Query must be a string");return r(h(t))},i.stringify=function(t){return f.default.Value.stringify(t)},i.simplify=function(t){var s=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];return f.default.Value.simplify(t,s)};var e=_(t("../grammar/query")),f=_(t("./types"));function _(t){return t&&t.__esModule?t:{default:t}}function h(t){if("string"!=typeof t)throw new Error("Query must be a string");return e.default.parse(t,{types:f.default})}function r(t){if(!t||"function"!=typeof t.reduce)throw new Error("Tree must be a parsed AST");return t.reduce()}},{"../grammar/query":3,"./types":2}],2:[function(t,s,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var e=function(){return function(t,s){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,s){var i=[],e=!0,f=!1,_=void 0;try{for(var h,r=t[Symbol.iterator]();!(e=(h=r.next()).done)&&(i.push(h.value),!s||i.length!==s);e=!0);}catch(t){f=!0,_=t}finally{try{!e&&r.return&&r.return()}finally{if(f)throw _}}return i}(t,s);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();var f={Value:{reduce:function(){return this.value.reduce()},stringify:function(t){var s=e(t,1)[0];return f[s].stringify(t)},simplify:function(t,s){var i,_=s.disallow,h=void 0===_?[]:_,r=e(t,1)[0];return i=r,h.some(function(t){return i===t})?["Text",f.Value.stringify(t)]:"function"==typeof f[r].simplify?[r,f[r].simplify(t,s)]:t}},Text:{reduce:function(){return["Text",this.text]},stringify:function(t){return e(t,2)[1]}},Values:{reduce:function(){return this.elements.map(function(t){return f.Value.reduce.call(t)})},stringify:function(t){return t.map(function(t){return f.Value.stringify(t)}).join(" ")},simplify:function(t,s){return t.map(function(t){return f.Value.simplify(t,s)})}},Pair:{reduce:function(){return["Pair",this.k.text.toLowerCase(),this.v.text]},stringify:function(t){var s=e(t,3);return s[1]+":"+s[2]}},Group:{reduce:function(){return["Group",this.root.reduce()]},stringify:function(t){var s=e(t,2)[1];return"("+f.Value.stringify(s)+")"}},And:{reduce:function(){return["And",f.Values.reduce.call(this)]},stringify:function(t){var s=e(t,2)[1];return f.Values.stringify(s)},simplify:function(t,s){var i=e(t,2)[1];return f.Values.simplify(i,s)}},Or:{reduce:function(){return["Or",[this.value.reduce()].concat(this.or_groups.reduce())]},stringify:function(t){return e(t,2)[1].map(function(t){return f.Value.stringify(t)}).join(" OR ")},simplify:function(t,s){var i=e(t,2)[1];return f.Values.simplify(i,s)}},Exactly:{reduce:function(){return["Exactly",this.value.text]},stringify:function(t){return'"'+e(t,2)[1]+'"'}},Including:{reduce:function(){return["Including",this.value.reduce()]},stringify:function(t){var s=e(t,2)[1];return f.Value.stringify(s)},simplify:function(t,s){var i=e(t,2)[1];return f.Value.simplify(i,s)}},Excluding:{reduce:function(){return["Excluding",this.value.reduce()]},stringify:function(t){var s=e(t,2)[1];return"-"+f.Value.stringify(s)},simplify:function(t,s){var i=e(t,2)[1];return f.Value.simplify(i,s)}},List:{reduce:function(){return["List",this.list_name.screen_name.text,this.list_name.list_slug.text]},stringify:function(t){var s=e(t,3);return"list:"+s[1]+"/"+s[2]}}};i.default=f},{}],3:[function(t,s,i){!function(){"use strict";var s=function(t,s){if(!t||!s)return t;for(var i in s)t[i]!==s[i]&&(t[i]=s[i]);return t},e=function(t,s){var i=function(){};i.prototype=s.prototype,t.prototype=new i,t.prototype.constructor=t},f=function(t,s,i){this.text=t,this.offset=s,this.elements=i||[]};f.prototype.forEach=function(t,s){for(var i=this.elements,e=0,f=i.length;e<f;e++)t.call(s,i[e],e,i)};var _=function(t,s,i){f.apply(this,arguments),this.value=i[1],this.query=i[1]};e(_,f);var h=function(t,s,i){f.apply(this,arguments),this.value=i[0],this.operator=i[0]};e(h,f);var r=function(t,s,i){f.apply(this,arguments),this.value=i[1],this.base=i[1]};e(r,f);var n=function(t,s,i){f.apply(this,arguments),this.value=i[1]};e(n,f);var o=function(t,s,i){f.apply(this,arguments),this.value=i[0],this.orable=i[0],this.or_groups=i[1]};e(o,f);var u=function(t,s,i){f.apply(this,arguments),this.or_sep=i[0],this.value=i[1],this.orable=i[1]};e(u,f);var a=function(t,s,i){f.apply(this,arguments),this.value=i[1],this.base=i[1]};e(a,f);var l=function(t,s,i){f.apply(this,arguments),this.root=i[1]};e(l,f);var c=function(t,s,i){f.apply(this,arguments),this.k=i[0],this.slug=i[0],this.sep=i[1],this.v=i[2],this.word=i[2]};e(c,f);var p=function(t,s,i){f.apply(this,arguments),this.sep=i[1],this.list_name=i[2]};e(p,f);var d=function(t,s,i){f.apply(this,arguments),this.value=i[1]};e(d,f);var g=function(t,s,i){f.apply(this,arguments),this.tag=i[1]};e(g,f);var v=function(t,s,i){f.apply(this,arguments),this.tag=i[1]};e(v,f);var y=function(t,s,i){f.apply(this,arguments),this.screen_name=i[1]};e(y,f);var b=function(t,s,i){f.apply(this,arguments),this.screen_name=i[0],this.list_slug=i[2]};e(b,f);var w=function(t,s,i){f.apply(this,arguments),this.slug=i[1]};e(w,f);var x=function(t,s,i){f.apply(this,arguments),this.d=i[9]};e(x,f);var m=function(t,s,i){f.apply(this,arguments),this.d=i[0]};e(m,f);var S={},z={_read_root:function(){var t=S,i=this._offset;this._cache._root=this._cache._root||{};var e=this._cache._root[i];if(e)return this._offset=e[1],e[0];for(var h=this._offset,r=new Array(3),n=S,o=0,u=this._offset,a=[],l=!0;l!==S;)(l=this._read___())!==S&&(a.push(l),--o);if(o<=0?(n=new f(this._input.substring(u,this._offset),u,a),this._offset=this._offset):n=S,n!==S){r[0]=n;var c;if((c=this._read_query())!==S){r[1]=c;for(var p=S,d=0,g=this._offset,v=[],y=!0;y!==S;)(y=this._read___())!==S&&(v.push(y),--d);d<=0?(p=new f(this._input.substring(g,this._offset),g,v),this._offset=this._offset):p=S,p!==S?r[2]=p:(r=null,this._offset=h)}else r=null,this._offset=h}else r=null,this._offset=h;return null===r?t=S:(t=new _(this._input.substring(h,this._offset),h,r),this._offset=this._offset),s(t,this._types.Value),this._cache._root[i]=[t,this._offset],t},_read_query:function(){var t=S,i=this._offset;this._cache._query=this._cache._query||{};var e=this._cache._query[i];if(e)return this._offset=e[1],e[0];for(var _=1,r=this._offset,n=[],o=!0;o!==S;){var u,a=this._offset,l=new Array(2);if((u=this._read_operator())!==S){l[0]=u;for(var c=S,p=0,d=this._offset,g=[],v=!0;v!==S;)(v=this._read___())!==S&&(g.push(v),--p);p<=0?(c=new f(this._input.substring(d,this._offset),d,g),this._offset=this._offset):c=S,c!==S?l[1]=c:(l=null,this._offset=a)}else l=null,this._offset=a;null===l?o=S:(o=new h(this._input.substring(a,this._offset),a,l),this._offset=this._offset),o!==S&&(n.push(o),--_)}return _<=0?(t=new f(this._input.substring(r,this._offset),r,n),this._offset=this._offset):t=S,s(t,this._types.And),this._cache._query[i]=[t,this._offset],t},_read_operator:function(){var t=S,s=this._offset;this._cache._operator=this._cache._operator||{};var i=this._cache._operator[s];if(i)return this._offset=i[1],i[0];var e=this._offset;return(t=this._read_excluding())===S&&(this._offset=e,(t=this._read_including())===S&&(this._offset=e)),this._cache._operator[s]=[t,this._offset],t},_read_excluding:function(){var t=S,i=this._offset;this._cache._excluding=this._cache._excluding||{};var e=this._cache._excluding[i];if(e)return this._offset=e[1],e[0];var _=this._offset,h=new Array(2),n=S,o=null;if(this._offset<this._inputSize&&(o=this._input.substring(this._offset,this._offset+1)),"-"===o?(n=new f(this._input.substring(this._offset,this._offset+1),this._offset),this._offset=this._offset+1):(n=S,this._offset>this._failure&&(this._failure=this._offset,this._expected=[]),this._offset===this._failure&&this._expected.push('"-"')),n!==S){h[0]=n;var u;(u=this._read_base())!==S?h[1]=u:(h=null,this._offset=_)}else h=null,this._offset=_;return null===h?t=S:(t=new r(this._input.substring(_,this._offset),_,h),this._offset=this._offset),s(t,this._types.Excluding),this._cache._excluding[i]=[t,this._offset],t},_read_including:function(){var t=S,i=this._offset;this._cache._including=this._cache._including||{};var e=this._cache._including[i];if(e)return this._offset=e[1],e[0];var _=this._offset,h=new Array(2),r=S,o=null;if(this._offset<this._inputSize&&(o=this._input.substring(this._offset,this._offset+0)),""===o?(r=new f(this._input.substring(this._offset,this._offset+0),this._offset),this._offset=this._offset+0):(r=S,this._offset>this._failure&&(this._failure=this._offset,this._expected=[]),this._offset===this._failure&&this._expected.push('""')),r!==S){h[0]=r;var u=S,a=this._offset;(u=this._read_or())===S&&(this._offset=a,(u=this._read_base())===S&&(this._offset=a)),u!==S?h[1]=u:(h=null,this._offset=_)}else h=null,this._offset=_;return null===h?t=S:(t=new n(this._input.substring(_,this._offset),_,h),this._offset=this._offset),s(t,this._types.Including),this._cache._including[i]=[t,this._offset],t},_read_or:function(){var t=S,i=this._offset;this._cache._or=this._cache._or||{};var e=this._cache._or[i];if(e)return this._offset=e[1],e[0];var f,_=this._offset,h=new Array(2);if((f=this._read_orable())!==S){h[0]=f;var r;(r=this._read_or_groups())!==S?h[1]=r:(h=null,this._offset=_)}else h=null,this._offset=_;return null===h?t=S:(t=new o(this._input.substring(_,this._offset),_,h),this._offset=this._offset),s(t,this._types.Or),this._cache._or[i]=[t,this._offset],t},_read_or_groups:function(){var t=S,i=this._offset;this._cache._or_groups=this._cache._or_groups||{};var e=this._cache._or_groups[i];if(e)return this._offset=e[1],e[0];for(var _=1,h=this._offset,r=[],n=!0;n!==S;){var o,a=this._offset,l=new Array(2);if((o=this._read_or_sep())!==S){l[0]=o;var c;(c=this._read_orable())!==S?l[1]=c:(l=null,this._offset=a)}else l=null,this._offset=a;null===l?n=S:(n=new u(this._input.substring(a,this._offset),a,l),this._offset=this._offset),n!==S&&(r.push(n),--_)}return _<=0?(t=new f(this._input.substring(h,this._offset),h,r),this._offset=this._offset):t=S,s(t,this._types.Values),this._cache._or_groups[i]=[t,this._offset],t},_read_orable:function(){var t=S,i=this._offset;this._cache._orable=this._cache._orable||{};var e=this._cache._orable[i];if(e)return this._offset=e[1],e[0];var _=this._offset,h=new Array(2),r=S,n=null;if(this._offset<this._inputSize&&(n=this._input.substring(this._offset,this._offset+0)),""===n?(r=new f(this._input.substring(this._offset,this._offset+0),this._offset),this._offset=this._offset+0):(r=S,this._offset>this._failure&&(this._failure=this._offset,this._expected=[]),this._offset===this._failure&&this._expected.push('""')),r!==S){h[0]=r;var o;(o=this._read_base())!==S?h[1]=o:(h=null,this._offset=_)}else h=null,this._offset=_;return null===h?t=S:(t=new a(this._input.substring(_,this._offset),_,h),this._offset=this._offset),s(t,this._types.Including),this._cache._orable[i]=[t,this._offset],t},_read_base:function(){var t=S,s=this._offset;this._cache._base=this._cache._base||{};var i=this._cache._base[s];if(i)return this._offset=i[1],i[0];var e=this._offset;return(t=this._read_group())===S&&(this._offset=e,(t=this._read_list())===S&&(this._offset=e,(t=this._read_pair())===S&&(this._offset=e,(t=this._read_exact())===S&&(this._offset=e,(t=this._read_hashtag())===S&&(this._offset=e,(t=this._read_mention())===S&&(this._offset=e,(t=this._read_word())===S&&(this._offset=e))))))),this._cache._base[s]=[t,this._offset],t},_read_group:function(){var t=S,i=this._offset;this._cache._group=this._cache._group||{};var e=this._cache._group[i];if(e)return this._offset=e[1],e[0];var _=this._offset,h=new Array(3),r=S,n=null;if(this._offset<this._inputSize&&(n=this._input.substring(this._offset,this._offset+1)),"("===n?(r=new f(this._input.substring(this._offset,this._offset+1),this._offset),this._offset=this._offset+1):(r=S,this._offset>this._failure&&(this._failure=this._offset,this._expected=[]),this._offset===this._failure&&this._expected.push('"("')),r!==S){h[0]=r;var o;if((o=this._read_root())!==S){h[1]=o;var u=S,a=null;this._offset<this._inputSize&&(a=this._input.substring(this._offset,this._offset+1)),")"===a?(u=new f(this._input.substring(this._offset,this._offset+1),this._offset),this._offset=this._offset+1):(u=S,this._offset>this._failure&&(this._failure=this._offset,this._expected=[]),this._offset===this._failure&&this._expected.push('")"')),u!==S?h[2]=u:(h=null,this._offset=_)}else h=null,this._offset=_}else h=null,this._offset=_;return null===h?t=S:(t=new l(this._input.substring(_,this._offset),_,h),this._offset=this._offset),s(t,this._types.Group),this._cache._group[i]=[t,this._offset],t},_read_pair:function(){var t=S,i=this._offset;this._cache._pair=this._cache._pair||{};var e=this._cache._pair[i];if(e)return this._offset=e[1],e[0];var f,_=this._offset,h=new Array(3);if((f=this._read_slug())!==S){h[0]=f;var r;if((r=this._read_sep())!==S){h[1]=r;var n;(n=this._read_word())!==S?h[2]=n:(h=null,this._offset=_)}else h=null,this._offset=_}else h=null,this._offset=_;return null===h?t=S:(t=new c(this._input.substring(_,this._offset),_,h),this._offset=this._offset),s(t,this._types.Pair),this._cache._pair[i]=[t,this._offset],t},_read_list:function(){var t=S,i=this._offset;this._cache._list=this._cache._list||{};var e=this._cache._list[i];if(e)return this._offset=e[1],e[0];var _=this._offset,h=new Array(3),r=S,n=null;if(this._offset<this._inputSize&&(n=this._input.substring(this._offset,this._offset+4)),"list"===n?(r=new f(this._input.substring(this._offset,this._offset+4),this._offset),this._offset=this._offset+4):(r=S,this._offset>this._failure&&(this._failure=this._offset,this._expected=[]),this._offset===this._failure&&this._expected.push('"list"')),r!==S){h[0]=r;var o;if((o=this._read_sep())!==S){h[1]=o;var u;(u=this._read_list_name())!==S?h[2]=u:(h=null,this._offset=_)}else h=null,this._offset=_}else h=null,this._offset=_;return null===h?t=S:(t=new p(this._input.substring(_,this._offset),_,h),this._offset=this._offset),s(t,this._types.List),this._cache._list[i]=[t,this._offset],t},_read_exact:function(){var t=S,i=this._offset;this._cache._exact=this._cache._exact||{};var e=this._cache._exact[i];if(e)return this._offset=e[1],e[0];var _=this._offset,h=new Array(3),r=S,n=null;if(this._offset<this._inputSize&&(n=this._input.substring(this._offset,this._offset+1)),'"'===n?(r=new f(this._input.substring(this._offset,this._offset+1),this._offset),this._offset=this._offset+1):(r=S,this._offset>this._failure&&(this._failure=this._offset,this._expected=[]),this._offset===this._failure&&this._expected.push("'\"'")),r!==S){h[0]=r;for(var o=S,u=0,a=this._offset,l=[],c=!0;c!==S;){var p=null;this._offset<this._inputSize&&(p=this._input.substring(this._offset,this._offset+1)),null!==p&&/^[^\"]/.test(p)?(c=new f(this._input.substring(this._offset,this._offset+1),this._offset),this._offset=this._offset+1):(c=S,this._offset>this._failure&&(this._failure=this._offset,this._expected=[]),this._offset===this._failure&&this._expected.push('[^\\"]')),c!==S&&(l.push(c),--u)}if(u<=0?(o=new f(this._input.substring(a,this._offset),a,l),this._offset=this._offset):o=S,o!==S){h[1]=o;var g=S,v=null;this._offset<this._inputSize&&(v=this._input.substring(this._offset,this._offset+1)),'"'===v?(g=new f(this._input.substring(this._offset,this._offset+1),this._offset),this._offset=this._offset+1):(g=S,this._offset>this._failure&&(this._failure=this._offset,this._expected=[]),this._offset===this._failure&&this._expected.push("'\"'")),g!==S?h[2]=g:(h=null,this._offset=_)}else h=null,this._offset=_}else h=null,this._offset=_;return null===h?t=S:(t=new d(this._input.substring(_,this._offset),_,h),this._offset=this._offset),s(t,this._types.Exactly),this._cache._exact[i]=[t,this._offset],t},_read_hashtag:function(){var t=S,i=this._offset;this._cache._hashtag=this._cache._hashtag||{};var e=this._cache._hashtag[i];if(e)return this._offset=e[1],e[0];var _=this._offset,h=new Array(2),r=S,n=null;if(this._offset<this._inputSize&&(n=this._input.substring(this._offset,this._offset+1)),"#"===n?(r=new f(this._input.substring(this._offset,this._offset+1),this._offset),this._offset=this._offset+1):(r=S,this._offset>this._failure&&(this._failure=this._offset,this._expected=[]),this._offset===this._failure&&this._expected.push('"#"')),r!==S){h[0]=r;var o;(o=this._read_tag())!==S?h[1]=o:(h=null,this._offset=_)}else h=null,this._offset=_;return null===h?t=S:(t=new g(this._input.substring(_,this._offset),_,h),this._offset=this._offset),s(t,this._types.Text),this._cache._hashtag[i]=[t,this._offset],t},_read_cashtag:function(){var t=S,i=this._offset;this._cache._cashtag=this._cache._cashtag||{};var e=this._cache._cashtag[i];if(e)return this._offset=e[1],e[0];var _=this._offset,h=new Array(2),r=S,n=null;if(this._offset<this._inputSize&&(n=this._input.substring(this._offset,this._offset+1)),"$"===n?(r=new f(this._input.substring(this._offset,this._offset+1),this._offset),this._offset=this._offset+1):(r=S,this._offset>this._failure&&(this._failure=this._offset,this._expected=[]),this._offset===this._failure&&this._expected.push('"$"')),r!==S){h[0]=r;var o;(o=this._read_tag())!==S?h[1]=o:(h=null,this._offset=_)}else h=null,this._offset=_;return null===h?t=S:(t=new v(this._input.substring(_,this._offset),_,h),this._offset=this._offset),s(t,this._types.Text),this._cache._cashtag[i]=[t,this._offset],t},_read_mention:function(){var t=S,i=this._offset;this._cache._mention=this._cache._mention||{};var e=this._cache._mention[i];if(e)return this._offset=e[1],e[0];var _=this._offset,h=new Array(2),r=S,n=null;if(this._offset<this._inputSize&&(n=this._input.substring(this._offset,this._offset+0)),""===n?(r=new f(this._input.substring(this._offset,this._offset+0),this._offset),this._offset=this._offset+0):(r=S,this._offset>this._failure&&(this._failure=this._offset,this._expected=[]),this._offset===this._failure&&this._expected.push('""')),r!==S){h[0]=r;var o;(o=this._read_screen_name())!==S?h[1]=o:(h=null,this._offset=_)}else h=null,this._offset=_;return null===h?t=S:(t=new y(this._input.substring(_,this._offset),_,h),this._offset=this._offset),s(t,this._types.Text),this._cache._mention[i]=[t,this._offset],t},_read_word:function(){var t=S,i=this._offset;this._cache._word=this._cache._word||{};var e=this._cache._word[i];if(e)return this._offset=e[1],e[0];var _=this._offset,h=new Array(2),r=S,n=this._offset,o=null;if(this._offset<this._inputSize&&(o=this._input.substring(this._offset,this._offset+1)),"+"===o?(r=new f(this._input.substring(this._offset,this._offset+1),this._offset),this._offset=this._offset+1):(r=S,this._offset>this._failure&&(this._failure=this._offset,this._expected=[]),this._offset===this._failure&&this._expected.push('"+"')),r===S&&(r=new f(this._input.substring(n,n),n),this._offset=n),r!==S){h[0]=r;for(var u=S,a=1,l=this._offset,c=[],p=!0;p!==S;){var d=null;this._offset<this._inputSize&&(d=this._input.substring(this._offset,this._offset+1)),null!==d&&/^[^\s\)\(]/.test(d)?(p=new f(this._input.substring(this._offset,this._offset+1),this._offset),this._offset=this._offset+1):(p=S,this._offset>this._failure&&(this._failure=this._offset,this._expected=[]),this._offset===this._failure&&this._expected.push("[^\\s\\)\\(]")),p!==S&&(c.push(p),--a)}a<=0?(u=new f(this._input.substring(l,this._offset),l,c),this._offset=this._offset):u=S,u!==S?h[1]=u:(h=null,this._offset=_)}else h=null,this._offset=_;return null===h?t=S:(t=new f(this._input.substring(_,this._offset),_,h),this._offset=this._offset),s(t,this._types.Text),this._cache._word[i]=[t,this._offset],t},_read_or_sep:function(){var t=S,s=this._offset;this._cache._or_sep=this._cache._or_sep||{};var i=this._cache._or_sep[s];if(i)return this._offset=i[1],i[0];for(var e=this._offset,_=new Array(3),h=S,r=1,n=this._offset,o=[],u=!0;u!==S;)(u=this._read___())!==S&&(o.push(u),--r);if(r<=0?(h=new f(this._input.substring(n,this._offset),n,o),this._offset=this._offset):h=S,h!==S){_[0]=h;var a=S,l=null;if(this._offset<this._inputSize&&(l=this._input.substring(this._offset,this._offset+2)),"OR"===l?(a=new f(this._input.substring(this._offset,this._offset+2),this._offset),this._offset=this._offset+2):(a=S,this._offset>this._failure&&(this._failure=this._offset,this._expected=[]),this._offset===this._failure&&this._expected.push('"OR"')),a!==S){_[1]=a;for(var c=S,p=1,d=this._offset,g=[],v=!0;v!==S;)(v=this._read___())!==S&&(g.push(v),--p);p<=0?(c=new f(this._input.substring(d,this._offset),d,g),this._offset=this._offset):c=S,c!==S?_[2]=c:(_=null,this._offset=e)}else _=null,this._offset=e}else _=null,this._offset=e;return null===_?t=S:(t=new f(this._input.substring(e,this._offset),e,_),this._offset=this._offset),this._cache._or_sep[s]=[t,this._offset],t},_read_list_name:function(){var t=S,s=this._offset;this._cache._list_name=this._cache._list_name||{};var i=this._cache._list_name[s];if(i)return this._offset=i[1],i[0];var e,_=this._offset,h=new Array(3);if((e=this._read_screen_name())!==S){h[0]=e;var r=S,n=null;if(this._offset<this._inputSize&&(n=this._input.substring(this._offset,this._offset+1)),"/"===n?(r=new f(this._input.substring(this._offset,this._offset+1),this._offset),this._offset=this._offset+1):(r=S,this._offset>this._failure&&(this._failure=this._offset,this._expected=[]),this._offset===this._failure&&this._expected.push('"/"')),r!==S){h[1]=r;var o;(o=this._read_list_slug())!==S?h[2]=o:(h=null,this._offset=_)}else h=null,this._offset=_}else h=null,this._offset=_;return null===h?t=S:(t=new b(this._input.substring(_,this._offset),_,h),this._offset=this._offset),this._cache._list_name[s]=[t,this._offset],t},_read_list_slug:function(){var t=S,s=this._offset;this._cache._list_slug=this._cache._list_slug||{};var i=this._cache._list_slug[s];if(i)return this._offset=i[1],i[0];for(var e=1,_=this._offset,h=[],r=!0;r!==S;){var n=null;this._offset<this._inputSize&&(n=this._input.substring(this._offset,this._offset+1)),null!==n&&/^[a-z-]/.test(n)?(r=new f(this._input.substring(this._offset,this._offset+1),this._offset),this._offset=this._offset+1):(r=S,this._offset>this._failure&&(this._failure=this._offset,this._expected=[]),this._offset===this._failure&&this._expected.push("[a-z-]")),r!==S&&(h.push(r),--e)}return e<=0?(t=new f(this._input.substring(_,this._offset),_,h),this._offset=this._offset):t=S,this._cache._list_slug[s]=[t,this._offset],t},_read_screen_name:function(){var t=S,s=this._offset;this._cache._screen_name=this._cache._screen_name||{};var i=this._cache._screen_name[s];if(i)return this._offset=i[1],i[0];var e=this._offset,_=new Array(2),h=S,r=this._offset,n=null;if(this._offset<this._inputSize&&(n=this._input.substring(this._offset,this._offset+1)),"@"===n?(h=new f(this._input.substring(this._offset,this._offset+1),this._offset),this._offset=this._offset+1):(h=S,this._offset>this._failure&&(this._failure=this._offset,this._expected=[]),this._offset===this._failure&&this._expected.push('"@"')),h===S&&(h=new f(this._input.substring(r,r),r),this._offset=r),h!==S){_[0]=h;var o;(o=this._read_slug())!==S?_[1]=o:(_=null,this._offset=e)}else _=null,this._offset=e;return null===_?t=S:(t=new w(this._input.substring(e,this._offset),e,_),this._offset=this._offset),this._cache._screen_name[s]=[t,this._offset],t},_read_date:function(){var t=S,s=this._offset;this._cache._date=this._cache._date||{};var i=this._cache._date[s];if(i)return this._offset=i[1],i[0];var e,_=this._offset,h=new Array(10);if((e=this._read_d())!==S){h[0]=e;var r;if((r=this._read_d())!==S){h[1]=r;var n;if((n=this._read_d())!==S){h[2]=n;var o;if((o=this._read_d())!==S){h[3]=o;var u=S,a=null;if(this._offset<this._inputSize&&(a=this._input.substring(this._offset,this._offset+1)),"-"===a?(u=new f(this._input.substring(this._offset,this._offset+1),this._offset),this._offset=this._offset+1):(u=S,this._offset>this._failure&&(this._failure=this._offset,this._expected=[]),this._offset===this._failure&&this._expected.push('"-"')),u!==S){h[4]=u;var l;if((l=this._read_d())!==S){h[5]=l;var c;if((c=this._read_d())!==S){h[6]=c;var p=S,d=null;if(this._offset<this._inputSize&&(d=this._input.substring(this._offset,this._offset+1)),"-"===d?(p=new f(this._input.substring(this._offset,this._offset+1),this._offset),this._offset=this._offset+1):(p=S,this._offset>this._failure&&(this._failure=this._offset,this._expected=[]),this._offset===this._failure&&this._expected.push('"-"')),p!==S){h[7]=p;var g;if((g=this._read_d())!==S){h[8]=g;var v;(v=this._read_d())!==S?h[9]=v:(h=null,this._offset=_)}else h=null,this._offset=_}else h=null,this._offset=_}else h=null,this._offset=_}else h=null,this._offset=_}else h=null,this._offset=_}else h=null,this._offset=_}else h=null,this._offset=_}else h=null,this._offset=_}else h=null,this._offset=_;return null===h?t=S:(t=new x(this._input.substring(_,this._offset),_,h),this._offset=this._offset),this._cache._date[s]=[t,this._offset],t},_read_tag:function(){var t,s=this._offset;this._cache._tag=this._cache._tag||{};var i=this._cache._tag[s];return i?(this._offset=i[1],i[0]):(t=this._read_slug(),this._cache._tag[s]=[t,this._offset],t)},_read_slug:function(){var t=S,s=this._offset;this._cache._slug=this._cache._slug||{};var i=this._cache._slug[s];if(i)return this._offset=i[1],i[0];for(var e=1,_=this._offset,h=[],r=!0;r!==S;){var n=null;this._offset<this._inputSize&&(n=this._input.substring(this._offset,this._offset+1)),null!==n&&/^[a-zA-Z0-9_]/.test(n)?(r=new f(this._input.substring(this._offset,this._offset+1),this._offset),this._offset=this._offset+1):(r=S,this._offset>this._failure&&(this._failure=this._offset,this._expected=[]),this._offset===this._failure&&this._expected.push("[a-zA-Z0-9_]")),r!==S&&(h.push(r),--e)}return e<=0?(t=new f(this._input.substring(_,this._offset),_,h),this._offset=this._offset):t=S,this._cache._slug[s]=[t,this._offset],t},_read_sep:function(){var t=S,s=this._offset;this._cache._sep=this._cache._sep||{};var i=this._cache._sep[s];if(i)return this._offset=i[1],i[0];var e=null;return this._offset<this._inputSize&&(e=this._input.substring(this._offset,this._offset+1)),":"===e?(t=new f(this._input.substring(this._offset,this._offset+1),this._offset),this._offset=this._offset+1):(t=S,this._offset>this._failure&&(this._failure=this._offset,this._expected=[]),this._offset===this._failure&&this._expected.push('":"')),this._cache._sep[s]=[t,this._offset],t},_read_integer:function(){var t=S,s=this._offset;this._cache._integer=this._cache._integer||{};var i=this._cache._integer[s];if(i)return this._offset=i[1],i[0];var e,_=this._offset,h=new Array(2);if((e=this._read_d())!==S){h[0]=e;for(var r=S,n=0,o=this._offset,u=[],a=!0;a!==S;)(a=this._read_d())!==S&&(u.push(a),--n);n<=0?(r=new f(this._input.substring(o,this._offset),o,u),this._offset=this._offset):r=S,r!==S?h[1]=r:(h=null,this._offset=_)}else h=null,this._offset=_;return null===h?t=S:(t=new m(this._input.substring(_,this._offset),_,h),this._offset=this._offset),this._cache._integer[s]=[t,this._offset],t},_read_d:function(){var t=S,s=this._offset;this._cache._d=this._cache._d||{};var i=this._cache._d[s];if(i)return this._offset=i[1],i[0];var e=null;return this._offset<this._inputSize&&(e=this._input.substring(this._offset,this._offset+1)),null!==e&&/^[0-9]/.test(e)?(t=new f(this._input.substring(this._offset,this._offset+1),this._offset),this._offset=this._offset+1):(t=S,this._offset>this._failure&&(this._failure=this._offset,this._expected=[]),this._offset===this._failure&&this._expected.push("[0-9]")),this._cache._d[s]=[t,this._offset],t},_read___:function(){var t=S,s=this._offset;this._cache.___=this._cache.___||{};var i=this._cache.___[s];if(i)return this._offset=i[1],i[0];var e=null;return this._offset<this._inputSize&&(e=this._input.substring(this._offset,this._offset+1)),null!==e&&/^[\s]/.test(e)?(t=new f(this._input.substring(this._offset,this._offset+1),this._offset),this._offset=this._offset+1):(t=S,this._offset>this._failure&&(this._failure=this._offset,this._expected=[]),this._offset===this._failure&&this._expected.push("[\\s]")),this._cache.___[s]=[t,this._offset],t}},A=function(t,s,i){this._input=t,this._inputSize=t.length,this._actions=s,this._types=i,this._offset=0,this._cache={},this._failure=0,this._expected=[]};A.prototype.parse=function(){var t=this._read_root();if(t!==S&&this._offset===this._inputSize)return t;throw 0===this._expected.length&&(this._failure=this._offset,this._expected.push("<EOF>")),this.constructor.lastError={offset:this._offset,expected:this._expected},new SyntaxError(function(t,s,i){for(var e=t.split(/\n/g),f=0,_=0;_<=s;)_+=e[f].length+1,f+=1;var h="Line "+f+": expected "+i.join(", ")+"\n",r=e[f-1];for(h+=r+"\n",_-=r.length+1;_<s;)h+=" ",_+=1;return h+"^"}(this._input,this._failure,this._expected))};s(A.prototype,z);var V={Grammar:z,Parser:A,parse:function(t,s){return new A(t,(s=s||{}).actions,s.types).parse()}};"function"==typeof t&&"object"==typeof i?s(i,V):(void 0!==this?this:window).Query=V}()},{}]},{},[1])(1)});